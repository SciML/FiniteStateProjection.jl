<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tips &amp; Tricks · FiniteStateProjection.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><script src="../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">FiniteStateProjection.jl</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li><a class="tocitem" href="mainapi.html">Main API</a></li><li><a class="tocitem" href="indexhandlers.html">Index Handlers</a></li><li><a class="tocitem" href="matrix.html">Matrix Conversions</a></li><li><a class="tocitem" href="internal.html">Internal API</a></li><li class="is-active"><a class="tocitem" href="tips.html">Tips &amp; Tricks</a><ul class="internal"><li><a class="tocitem" href="#Solving-Linear-Equations"><span>Solving Linear Equations</span></a></li><li><a class="tocitem" href="#Picking-a-Solver"><span>Picking a Solver</span></a></li><li><a class="tocitem" href="#Further-Comments"><span>Further Comments</span></a></li></ul></li><li><a class="tocitem" href="examples.html">Examples</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="tips.html">Tips &amp; Tricks</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="tips.html">Tips &amp; Tricks</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/kaandocal/FiniteStateProjection.jl/blob/master/docs/src/tips.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="tips"><a class="docs-heading-anchor" href="#tips">Tips and Tricks</a><a id="tips-1"></a><a class="docs-heading-anchor-permalink" href="#tips" title="Permalink"></a></h1><p>The FSP approximates an infinite-dimensional system of equations by truncating it to a finite number of variables. The accuracy of the FSP therefore depends on how many variables are retained, ie.~what portion of the state space is modelled. While simple reaction networks with 1 or 2 species are not too difficult to handle using the FSP, a naive approach will require unfeasibly large truncations for systems of even moderate complexity.</p><h2 id="Solving-Linear-Equations"><a class="docs-heading-anchor" href="#Solving-Linear-Equations">Solving Linear Equations</a><a id="Solving-Linear-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-Linear-Equations" title="Permalink"></a></h2><p>The Chemical Master Equation is a set of linear ODEs, and there is a vast literature on efficiently solving these. FiniteStateProjection.jl currently offers two main approaches:</p><ul><li>Convert a reaction system into an <code>ODEFunction</code> for use with DifferentialEquations.jl</li><li>Convert a reaction system into a sparse matrix for use with any linear ODE solver</li></ul><p>While there are no official benchmarks yet the first method is likely going to be more efficient for systems with time-dependent reaction rates, while the second is recommended for time-homogeneous systems.</p><h2 id="Picking-a-Solver"><a class="docs-heading-anchor" href="#Picking-a-Solver">Picking a Solver</a><a id="Picking-a-Solver-1"></a><a class="docs-heading-anchor-permalink" href="#Picking-a-Solver" title="Permalink"></a></h2><p>The FSP generally results in <a href="https://en.wikipedia.org/wiki/Stiff_equation">stiff equations</a>, so using a stiff solver in generally is recommended. At the time of writing it seems like the best all-round solver is <code>CVODE_BDF</code> with the <code>GMRES</code> linear solver (requires <a href="https://github.com/SciML/Sundials.jl">Sundials.jl</a>):</p><pre><code class="language-julia hljs">using Sundials

(...)

sol = solve(prob, CVODE_BDF(linear_solver=:GMRES), atol=1e-6) # very fast</code></pre><p>For time-homogeneous systems where the right-hand side of the CME does not depend on <code>t</code>, solving the FSP is equivalent to computing the exponential-vector product <code>exp(A .* t) * u0</code>, where <code>A</code> is the evolution operator. This can be done very efficiently using the <code>expmv</code> function provided by <a href="https://github.com/acroy/Expokit.jl">Expokit.jl</a>:</p><pre><code class="nohighlight hljs">using Expokit

(...)

ut = expmv(t, A, u0, tol=1e-6)  # really fast</code></pre><h2 id="Further-Comments"><a class="docs-heading-anchor" href="#Further-Comments">Further Comments</a><a id="Further-Comments-1"></a><a class="docs-heading-anchor-permalink" href="#Further-Comments" title="Permalink"></a></h2><p>Choosing the right solver for large systems of ODEs can result in time savings on the order of 10-100x, and it is recommended that you experiment with a few solvers to see which works best in your case. This section is still work in progress and there has been a lot of research on accelerating the FSP and extending it to larger reaction networks which will hopefully be reviewed here soon. Feel free to share any comments or suggestions in this direction at the <a href="https://github.com/kaandocal/FiniteStateProjection.jl">Github repository</a>!</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="internal.html">« Internal API</a><a class="docs-footer-nextpage" href="examples.html">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.12 on <span class="colophon-date" title="Wednesday 26 January 2022 11:37">Wednesday 26 January 2022</span>. Using Julia version 1.6.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
